import{m as b,p as z,q as O,g as r,a as d,b as t,i as c,d as y,h as Y,w,f as m,l as _,t as p,F as V,z as j,e as F,k,s as $,o as i,v as E,n as P,A as W}from"./app-_dmu3dQ1.js";import{_ as q,a as A}from"./Footer-Dv3yLydd.js";const D={class:"flex flex-col min-h-screen"},X={class:"bg-gray-100 py-4"},G={class:"max-w-[1000px] mx-auto px-6"},I={class:"flex items-center space-x-2 text-sm"},J={class:"text-gray-800 font-medium"},K={class:"w-full px-6 mx-auto max-w-[1000px] py-8"},Q={class:"text-4xl py-4 md:text-5xl font-bold mb-6 text-center bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-purple-600"},R=["innerHTML"],Z={key:0},ee=["innerHTML"],te=["src"],se={key:2,class:"flex flex-col items-center my-6 space-y-4"},le={class:"space-y-2 text-sm text-gray-700"},oe={class:"flex items-center space-x-2"},ne={class:"flex items-center space-x-2"},ae=["disabled"],re={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ie={class:"bg-white p-6 rounded-2xl shadow-lg w-96 relative"},ue={key:0,class:"text-red-500 text-sm mt-1"},de={key:0,class:"text-red-500 text-sm mt-1"},pe={__name:"Show",props:{product:Object},setup(u){const C=u,x=b(!1),v=b(!1),M=b(!1),o=b({name:"",phone:"",product:"",amount:0}),n=b({name:"",phone:""}),H=()=>{M.value=!0,o.value.product=C.product.title,o.value.amount=C.product.price??1e3},N=()=>{M.value=!1,o.value={name:"",phone:"",product:"",amount:0},n.value={name:"",phone:""}},T=async()=>{if(n.value={},o.value.name.trim()||(n.value.name="Введите имя"),/^\+?\d[\d\s\-\(\)]{9,}$/.test(o.value.phone)||(n.value.phone="Введите корректный номер телефона"),Object.keys(n.value).length===0)try{const{data:e}=await W.post("/pay",o.value);window.location.href=e.url}catch(e){n.value=e.response?.data?.errors||{}}},B=a=>a?a.replace(/src="\/\/storage\//g,'src="/storage/'):"";let l=null,g=null,h=null;const S=()=>{if(!l)return;const a=window.scrollY*.2;l.style.transform=`translateY(${a}px)`},U=a=>{if(!l)return;const{innerWidth:e,innerHeight:s}=window,L=(a.clientX/e-.5)*20,f=(a.clientY/s-.5)*20;l.style.transform=`translate(${L}px, ${f+window.scrollY*.2}px)`};return z(()=>{document.querySelectorAll(".web-bg").forEach(e=>e.parentNode?.removeChild(e)),l=document.createElement("div"),l.classList.add("web-bg"),document.body.appendChild(l),g=S,h=U,window.addEventListener("scroll",g),window.addEventListener("mousemove",h)}),O(()=>{l&&l.parentNode&&(l.parentNode.removeChild(l),l=null),g&&window.removeEventListener("scroll",g),h&&window.removeEventListener("mousemove",h)}),(a,e)=>(i(),r(V,null,[d(y(Y),{title:u.product.title},null,8,["title"]),t("div",D,[d(q),t("nav",X,[t("div",G,[t("div",I,[d(y(_),{href:"/category",class:"text-gray-500 hover:text-gray-700"},{default:w(()=>[...e[4]||(e[4]=[m("Категории",-1)])]),_:1}),e[5]||(e[5]=t("span",{class:"text-gray-400"},"/",-1)),d(y(_),{href:`/category/${u.product.category.slug}`,class:"text-gray-500 hover:text-gray-700"},{default:w(()=>[m(p(u.product.category.title),1)]),_:1},8,["href"]),e[6]||(e[6]=t("span",{class:"text-gray-400"},"/",-1)),t("span",J,p(u.product.title),1)])])]),t("main",K,[t("h1",Q,p(u.product.title),1),t("div",{class:"product-description max-w-full mb-6",innerHTML:u.product.description},null,8,R),u.product.content_blocks?(i(),r("div",Z,[(i(!0),r(V,null,j(u.product.content_blocks,(s,L)=>(i(),r("div",{key:L,class:"mb-6"},[s.type==="text"?(i(),r("div",{key:0,class:"text-block",innerHTML:B(s.description)},null,8,ee)):c("",!0),s.type==="image"&&s.image?(i(),r("img",{key:1,src:`/storage/${s.image}`,class:"mx-auto my-4 rounded-lg shadow-sm",style:{"max-width":"100%",height:"auto"}},null,8,te)):c("",!0),s.type==="button"?(i(),r("div",se,[t("div",le,[t("label",oe,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=f=>x.value=f)},null,512),[[E,x.value]]),t("span",null,[e[8]||(e[8]=m("Я даю согласие на обработку данных в соответствии с ",-1)),d(y(_),{href:"/privacy",class:"text-blue-600 underline"},{default:w(()=>[...e[7]||(e[7]=[m("Политикой конфиденциальности",-1)])]),_:1})])]),t("label",ne,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=f=>v.value=f)},null,512),[[E,v.value]]),t("span",null,[e[10]||(e[10]=m("Я принимаю условия ",-1)),d(y(_),{href:"/oferta",class:"text-blue-600 underline"},{default:w(()=>[...e[9]||(e[9]=[m("Договора оферты",-1)])]),_:1})])])]),t("button",{disabled:!x.value||!v.value,onClick:H,class:P(["inline-block w-full sm:w-auto px-10 py-3 text-lg font-semibold text-white text-center rounded-2xl shadow-md transition-all duration-300",{"bg-gray-400 cursor-not-allowed":!x.value||!v.value,"bg-blue-600 hover:bg-blue-700 hover:shadow-lg active:scale-95":x.value&&v.value}])},p(s.button_text),11,ae)])):c("",!0)]))),128))])):c("",!0)]),d(A)]),M.value?(i(),r("div",re,[t("div",ie,[t("button",{onClick:N,class:"absolute top-2 right-3 text-gray-400 hover:text-gray-700 text-xl"},"×"),e[14]||(e[14]=t("h2",{class:"text-xl font-semibold mb-4 text-center"},"Введите данные для оплаты",-1)),t("form",{onSubmit:F(T,["prevent"]),class:"space-y-4"},[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Имя",-1)),k(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.name=s),type:"text",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",placeholder:"Введите имя"},null,512),[[$,o.value.name]]),n.value.name?(i(),r("p",ue,p(n.value.name),1)):c("",!0)]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Телефон",-1)),k(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.phone=s),type:"tel",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",placeholder:"+7 (___) ___-__-__"},null,512),[[$,o.value.phone]]),n.value.phone?(i(),r("p",de,p(n.value.phone),1)):c("",!0)]),e[13]||(e[13]=t("button",{type:"submit",class:"w-full py-2 text-white bg-blue-600 rounded-xl font-semibold hover:bg-blue-700 transition"}," Оплатить ",-1))],32)])])):c("",!0)],64))}};export{pe as default};
